{% extends 'admin/change_form.html' %} 

{% block extrahead %}

<script>
  document.addEventListener("DOMContentLoaded", (event) => {
    console.log("CODEEE HEREEEE")
    hideLoadingOverlay();
  });
</script>
<script>
  function submitForm() {
    const form = document.getElementById('charge-form');
    const clientId = form.querySelector('input[name="client_id"]').value;

    // Prepare the data as JSON
    const data = {
      client_id: clientId,
    };

    fetch('/api/client/admin-requests/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    })
    .then((response) => {
      response.json().then((responseJson)=>{
        window.location = responseJson.path
      })
      
    })
      .catch((error) => {
        console.log(error)
      });
  }
</script>

{{ block.super }}
{% endblock %}

{% block extrastyle %}
<style>
  .object-tools {
    display: flex !important;
    justify-content: flex-end;
  }

  {{ block.super }}
</style>

{{ block.super }}
{% endblock %}

{% block object-tools-items %}
<div style="margin-right:5px;">
  <form id="charge-form">
    <input type="hidden" value="{{ original.pk }}" name="client_id">
    <input type="button" class="modal-button" onclick="submitForm()" value="Charge client"></input>
  </form>
</div>

<div>

  <form id="send-sms-form" action="{% url 'client:generate-pdf' %}" method="get">
    <input type="hidden" name="client_id" value="{{ original.pk }}">
    <input type="submit" value="Generate PDF" class="submit-button" />
  </form>
</div>
{{ block.super }}
{% endblock %}

{% block content %} 
{{ block.super }} 
{% include "pre-loader.html" %} 
{% endblock %}
